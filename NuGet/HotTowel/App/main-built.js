/**
 * almond 0.2.0 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

(function(){var e,t,n;(function(o){function i(e,t){var n,o,i,r,a,s,c,u,l,f,d=t&&t.split("/"),v=w.map,p=v&&v["*"]||{};if(e&&"."===e.charAt(0)&&t){for(d=d.slice(0,d.length-1),e=d.concat(e.split("/")),u=0;e.length>u;u+=1)if(f=e[u],"."===f)e.splice(u,1),u-=1;else if(".."===f){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}if((d||p)&&v){for(n=e.split("/"),u=n.length;u>0;u-=1){if(o=n.slice(0,u).join("/"),d)for(l=d.length;l>0;l-=1)if(i=v[d.slice(0,l).join("/")],i&&(i=i[o])){r=i,a=u;break}if(r)break;!s&&p&&p[o]&&(s=p[o],c=u)}!r&&s&&(r=s,a=c),r&&(n.splice(0,a,r),e=n.join("/"))}return e}function r(e,t){return function(){return v.apply(o,b.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return i(t,e)}}function s(e){return function(t){g[e]=t}}function c(e){if(h.hasOwnProperty(e)){var t=h[e];delete h[e],y[e]=!0,d.apply(o,t)}if(!g.hasOwnProperty(e)&&!y.hasOwnProperty(e))throw Error("No "+e);return g[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function l(t,n,o){e.onResourceLoad&&t&&e.onResourceLoad({defined:n},{id:t},o)}function f(e){return function(){return w&&w.config&&w.config[e]||{}}}var d,v,p,m,g={},h={},w={},y={},b=[].slice;p=function(e,t){var n,o=u(e),r=o[0];return e=o[1],r&&(r=i(r,t),n=c(r)),r?e=n&&n.normalize?n.normalize(e,a(t)):i(e,t):(e=i(e,t),o=u(e),r=o[0],e=o[1],r&&(n=c(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},m={require:function(e){return r(e)},exports:function(e){var t=g[e];return t!==void 0?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:f(e)}}},d=function(e,t,n,i){var a,u,f,d,v,w,b=[];if(i=i||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,v=0;t.length>v;v+=1)if(d=p(t[v],i),u=d.f,"require"===u)b[v]=m.require(e);else if("exports"===u)b[v]=m.exports(e),w=!0;else if("module"===u)a=b[v]=m.module(e);else if(g.hasOwnProperty(u)||h.hasOwnProperty(u)||y.hasOwnProperty(u))b[v]=c(u);else{if(!d.p)throw Error(e+" missing "+u);d.p.load(d.n,r(i,!0),s(u),{}),b[v]=g[u]}f=n.apply(g[e],b),e&&(a&&a.exports!==o&&a.exports!==g[e]?g[e]=a.exports:f===o&&w||(g[e]=f))}else e&&(g[e]=n);l(e,g,b)},e=t=v=function(e,t,n,i,r){return"string"==typeof e?m[e]?m[e](t):c(p(e,t).f):(e.splice||(w=e,t.splice?(e=t,t=n,n=null):e=o),t=t||function(){},"function"==typeof n&&(n=i,i=r),i?d(o,e,t,n):setTimeout(function(){d(o,e,t,n)},15),v)},v.config=function(e){return w=e,v},n=function(e,t,n){t.splice||(n=t,t=[]),h[e]=[e,t,n]},n.amd={jQuery:!0}})(),n("durandal/amd/almond-custom",function(){}),n("durandal/system",["require"],function(t){var n,o=!1,i=Object.keys,r=Object.prototype.hasOwnProperty,a=Object.prototype.toString,s=!1;if(Function.prototype.bind&&("object"==typeof console||"function"==typeof console)&&"object"==typeof console.log)try{["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]=this.call(console[e],console)},Function.prototype.bind)}catch(c){s=!0}e.onResourceLoad=function(e,t){var n=e.defined[t.id];if(n)return"function"==typeof n?(n.prototype.__moduleId__=t.id,void 0):("string"!=typeof n&&(n.__moduleId__=t.id),void 0)};var u=function(){},l=function(){if("undefined"!=typeof console&&"function"==typeof console.log)if(window.opera)for(var e=0;arguments.length>e;)console.log("Item "+(e+1)+": "+arguments[e]),e++;else 1==Array.prototype.slice.call(arguments).length&&"string"==typeof Array.prototype.slice.call(arguments)[0]?console.log(""+Array.prototype.slice.call(arguments)):console.log(Array.prototype.slice.call(arguments));else Function.prototype.bind&&!s||"undefined"==typeof console||"object"!=typeof console.log||Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments))};return n={version:"1.0.2",noop:u,getModuleId:function(e){return e?e.__moduleId__:null},debug:function(e){return 1!=arguments.length?o:(o=e,o?(this.log=l,this.log("Debug mode enabled.")):(this.log("Debug mode disabled."),this.log=u),void 0)},isArray:function(e){return"[object Array]"===a.call(e)},log:u,defer:function(e){return $.Deferred(e)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=0|16*Math.random(),n="x"==e?t:8|3&t;return n.toString(16)})},acquire:function(){var e=Array.prototype.slice.call(arguments,0);return this.defer(function(n){t(e,function(){var e=arguments;setTimeout(function(){n.resolve.apply(n,e)},1)})}).promise()}},n.keys=i||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)r.call(e,n)&&(t[t.length]=n);return t},n}),n("durandal/viewEngine",["require"],function(){function e(e){var n=t(e);if(1==n.length)return n[0];for(var o=[],i=0;n.length>i;i++){var r=n[i];8!=r.nodeType&&o.push(r)}return o.length>1?$(o).wrapAll('<div class="durandal-wrapper"></div').parent().get(0):o[0]}var t;return t=$.parseHTML?function(e){return $.parseHTML(e)}:function(e){return $(e).get()},{viewExtension:".html",pluginPath:"text",createView:function(t,n){var o=e(n);return o.setAttribute("data-view",t),o}}}),n("durandal/viewLocator",["require","./system","./viewEngine"],function(e){function t(e,t){for(var n=0;e.length>n;n++){var o=e[n],i=o.getAttribute("data-view");if(i==t)return o}}function n(e){return(e+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")}var o=e("./system"),i=e("./viewEngine");return{useConvention:function(e,t,o){e=e||"viewmodels",t=t||"views",o=o||t;var i=RegExp(n(e),"gi");this.convertModuleIdToViewUrl=function(e){return e.replace(i,t)},this.convertViewUrlToAreaUrl=function(e,t){return o+"/"+t}},locateViewForObject:function(e,t){var n;if(e.getView&&(n=e.getView()))return this.locateView(n,null,t);if(e.viewUrl)return this.locateView(e.viewUrl,null,t);var i=o.getModuleId(e);return i?this.locateView(this.convertModuleIdToViewUrl(i),null,t):this.locateView(this.determineFallbackViewUrl(e),null,t)},convertModuleIdToViewUrl:function(e){return e},determineFallbackViewUrl:function(e){var t=/function (.{1,})\(/,n=t.exec(""+e.constructor),o=n&&n.length>1?n[1]:"";return"views/"+o},convertViewUrlToAreaUrl:function(e,t){return t},locateView:function(e,n,r){var a=this;return o.defer(function(s){if("string"==typeof e){if(-1!=e.indexOf(i.viewExtension)&&(e=e.substring(0,e.length-i.viewExtension.length)),n&&(e=a.convertViewUrlToAreaUrl(n,e)),r){var c=t(r,e);if(c)return s.resolve(c),void 0}var u=i.pluginPath+"!"+e+i.viewExtension;o.acquire(u).then(function(t){s.resolve(i.createView(e,t))})}else s.resolve(e)}).promise()}}}),n("durandal/viewModelBinder",["require","./system"],function(e){function t(e,t,o){if(!t||!e)return n.log("Insufficent Information to Bind",t,e),void 0;if(!t.getAttribute)return n.log("Unexpected View Type",t,e),void 0;var i=t.getAttribute("data-view");try{n.log("Binding",i,e),o()}catch(r){n.log(r.message,i,e)}}var n=e("./system");return{bindContext:function(e,n,o){if(o){var i=e.createChildContext(o);t(i,n,function(){ko.applyBindingsToNode(n,null,i)})}else t(e,n,function(){ko.applyBindings(e,n)})},bind:function(e,n){t(e,n,function(){ko.applyBindings(e,n),e.setView&&e.setView(n)})}}}),n("durandal/viewModel",["require","./system"],function(e){function t(e){return void 0==e&&(e={}),e.closeOnDeactivate||(e.closeOnDeactivate=s.defaults.closeOnDeactivate),e.beforeActivate||(e.beforeActivate=s.defaults.beforeActivate),e.afterDeactivate||(e.afterDeactivate=s.defaults.afterDeactivate),e.interpretResponse||(e.interpretResponse=s.defaults.interpretResponse),e.areSameItem||(e.areSameItem=s.defaults.areSameItem),e}function n(e,t,n,o){if(e&&e.deactivate){c.log("Deactivating",e);var i=e.deactivate(t);i&&i.then?i.then(function(){n.afterDeactivate(e,t),o.resolve(!0)}):(n.afterDeactivate(e,t),o.resolve(!0))}else e&&n.afterDeactivate(e,t),o.resolve(!0)}function o(e,t,n,o){if(e)if(e.activate){c.log("Activating",e);var i=e.activate(o);i&&i.then?i.then(function(){t(e),n(!0)}):(t(e),n(!0))}else t(e),n(!0);else n(!0)}function i(e,t,n){return c.defer(function(o){if(e&&e.canDeactivate){var i=e.canDeactivate(t);i.then?i.then(function(e){o.resolve(n.interpretResponse(e))}):o.resolve(n.interpretResponse(i))}else o.resolve(!0)}).promise()}function r(e,t,n,o){return c.defer(function(i){if(e==t())return i.resolve(!0),void 0;if(e&&e.canActivate){var r=e.canActivate(o);r.then?r.then(function(e){i.resolve(n.interpretResponse(e))}):i.resolve(n.interpretResponse(r))}else i.resolve(!0)}).promise()}function a(e,a){var s=ko.observable(null);a=t(a);var u=ko.computed({read:function(){return s()},write:function(e){u.viaSetter=!0,u.activateItem(e)}});return u.settings=a,u.isActivating=ko.observable(!1),u.canDeactivateItem=function(e,t){return i(e,t,a)},u.deactivateItem=function(e,t){return c.defer(function(o){u.canDeactivateItem(e,t).then(function(i){i?n(e,t,a,o):(u.notifySubscribers(),o.resolve(!1))})})},u.canActivateItem=function(e,t){return r(e,s,a,t)},u.activateItem=function(e,t){var i=u.viaSetter;return u.viaSetter=!1,c.defer(function(r){if(u.isActivating())return r.resolve(!1),void 0;u.isActivating(!0);var l=s();return a.areSameItem(l,e,t)?(u.isActivating(!1),r.resolve(!0),void 0):(u.canDeactivateItem(l,a.closeOnDeactivate).then(function(f){f?u.canActivateItem(e,t).then(function(f){f?c.defer(function(e){n(l,a.closeOnDeactivate,a,e)}).promise().then(function(){e=a.beforeActivate(e),o(e,s,function(e){u.isActivating(!1),r.resolve(e)},t)}):(i&&u.notifySubscribers(),u.isActivating(!1),r.resolve(!1))}):(i&&u.notifySubscribers(),u.isActivating(!1),r.resolve(!1))}),void 0)}).promise()},u.canActivate=function(){var t;return e?(t=e,e=!1):t=u(),u.canActivateItem(t)},u.activate=function(){var t;return e?(t=e,e=!1):t=u(),u.activateItem(t)},u.canDeactivate=function(e){return u.canDeactivateItem(u(),e)},u.deactivate=function(e){return u.deactivateItem(u(),e)},u.includeIn=function(e){e.canActivate=function(){return u.canActivate()},e.activate=function(){return u.activate()},e.canDeactivate=function(e){return u.canDeactivate(e)},e.deactivate=function(e){return u.deactivate(e)}},a.includeIn?u.includeIn(a.includeIn):e&&u.activate(),u.forItems=function(e){a.closeOnDeactivate=!1,a.determineNextItemToActivate=function(e,t){var n=t-1;return-1==n&&e.length>1?e[1]:n>-1&&e.length-1>n?e[n]:null},a.beforeActivate=function(t){var n=u();if(t){var o=e.indexOf(t);-1==o?e.push(t):t=e()[o]}else t=a.determineNextItemToActivate(e,n?e.indexOf(n):0);return t},a.afterDeactivate=function(t,n){n&&e.remove(t)};var t=u.canDeactivate;u.canDeactivate=function(n){return n?c.defer(function(t){function o(){for(var e=0;r.length>e;e++)if(!r[e])return t.resolve(!1),void 0;t.resolve(!0)}for(var i=e(),r=[],a=0;i.length>a;a++)u.canDeactivateItem(i[a],n).then(function(e){r.push(e),r.length==i.length&&o()})}).promise():t};var n=u.deactivate;return u.deactivate=function(t){return t?c.defer(function(n){function o(o){u.deactivateItem(o,t).then(function(){r++,e.remove(o),r==a&&n.resolve()})}for(var i=e(),r=0,a=i.length,s=0;a>s;s++)o(i[s])}).promise():n},u},u}var s,c=e("./system");return s={defaults:{closeOnDeactivate:!0,interpretResponse:function(e){if("string"==typeof e){var t=e.toLowerCase();return"yes"==t||"ok"==t}return e},areSameItem:function(e,t){return e==t},beforeActivate:function(e){return e},afterDeactivate:function(){}},activator:a}}),n("durandal/composition",["require","./viewLocator","./viewModelBinder","./viewEngine","./system","./viewModel"],function(e){function t(e){return e.model&&e.model.activate&&(d.activateDuringComposition&&void 0==e.activate||e.activate)}function n(e,n){t(e)?u.activator().activateItem(e.model).then(function(e){e&&n()}):n()}function o(e){for(var t=[],n={childElements:t,activeView:null},o=ko.virtualElements.firstChild(e);o;)1==o.nodeType&&(t.push(o),o.getAttribute(f)&&(n.activeView=o)),o=ko.virtualElements.nextSibling(o);return n}function i(e,t,n){n.activeView&&n.activeView.removeAttribute(f),t&&(n.model&&n.model.viewAttached&&(n.composingNewView||n.alwaysAttachView)&&n.model.viewAttached(t),t.setAttribute(f,!0)),n.afterCompose&&n.afterCompose(e,t,n)}var r=e("./viewLocator"),a=e("./viewModelBinder"),s=e("./viewEngine"),c=e("./system"),u=e("./viewModel"),l={},f="data-active-view",d={activateDuringComposition:!1,convertTransitionToModuleId:function(e){return"durandal/transitions/"+e},switchContent:function(e,t,n){if(n.transition=n.transition||this.defaultTransitionName,"string"==typeof n.transition&&t){var o=this.convertTransitionToModuleId(n.transition);c.acquire(o).then(function(o){n.transition=o,o(e,t,n).then(function(){i(e,t,n)})})}else n.cacheViews&&n.activeView&&$(n.activeView).css("display","none"),t?n.cacheViews?n.composingNewView?(n.viewElements.push(t),ko.virtualElements.prepend(e,t)):$(t).css("display",""):(ko.virtualElements.emptyNode(e),ko.virtualElements.prepend(e,t)):n.cacheViews||ko.virtualElements.emptyNode(e),i(e,t,n)},bindAndShow:function(e,t,o){o.composingNewView=o.cacheViews?-1==o.viewElements.indexOf(t):!0,n(o,function(){if(o.beforeBind&&o.beforeBind(e,t,o),o.preserveContext&&o.bindingContext)a.bindContext(o.bindingContext,t,o.model);else if(t){var n=o.model||l,i=ko.dataFor(t);i!=n&&(o.composingNewView||console.log("Warning...composing an existing view against a different model may go badly for you."),a.bind(n,t))}d.switchContent(e,t,o)})},defaultStrategy:function(e){return r.locateViewForObject(e.model,e.viewElements)},getSettings:function(e){var t={},n=ko.utils.unwrapObservable(e())||{};if("string"==typeof n)return n;var o=c.getModuleId(n);if(o)return{model:n};for(var i in n)if("string"==typeof i){var r=ko.utils.unwrapObservable(n[i]);t[i]=r}return t},executeStrategy:function(e,t){t.strategy(t).then(function(n){d.bindAndShow(e,n,t)})},inject:function(e,t){return t.model?t.view?(r.locateView(t.view,t.area,t.viewElements).then(function(n){d.bindAndShow(e,n,t)}),void 0):((void 0===t.view||t.view)&&(t.strategy||(t.strategy=this.defaultStrategy),"string"==typeof t.strategy?c.acquire(t.strategy).then(function(n){t.strategy=n,d.executeStrategy(e,t)}):this.executeStrategy(e,t)),void 0):(this.bindAndShow(e,null,t),void 0)},compose:function(e,t,n){"string"==typeof t&&(t=-1!==t.indexOf(s.viewExtension,t.length-s.viewExtension.length)?{view:t}:{model:t});var i=c.getModuleId(t);i&&(t={model:t});var a=o(e);t.bindingContext=n,t.activeView=a.activeView,t.cacheViews&&!t.viewElements&&(t.viewElements=a.childElements),t.model?"string"==typeof t.model?c.acquire(t.model).then(function(n){t.model="function"==typeof n?new n(e,t):n,d.inject(e,t)}):d.inject(e,t):t.view?(t.area=t.area||"partial",t.preserveContext=!0,r.locateView(t.view,t.area,t.viewElements).then(function(n){d.bindAndShow(e,n,t)})):this.bindAndShow(e,null,t)}};return ko.bindingHandlers.compose={update:function(e,t,n,o,i){var r=d.getSettings(t);d.compose(e,r,i)}},ko.virtualElements.allowedBindings.compose=!0,d}),n("durandal/widget",["require","./system","./composition"],function(e){var t=e("./system"),n=e("./composition"),o="data-part",i="["+o+"]",r={},a={},s={getParts:function(e){var n={};t.isArray(e)||(e=[e]);for(var r=0;e.length>r;r++){var a=e[r];if(a.getAttribute){var s=a.getAttribute(o);s&&(n[s]=a);for(var c=$(i,a),u=0;c.length>u;u++){var l=c.get(u);n[l.getAttribute(o)]=l}}}return n},getSettings:function(e){var t={},n=ko.utils.unwrapObservable(e())||{};if("string"==typeof n)t=n;else for(var o in n)if("string"==typeof o){var i=ko.utils.unwrapObservable(n[o]);t[o]=i}return t},registerKind:function(e){ko.bindingHandlers[e]={init:function(){return{controlsDescendantBindings:!0}},update:function(t,n,o,i,r){var a=s.getSettings(n);a.kind=e,s.create(t,a,r)}},ko.virtualElements.allowedBindings[e]=!0},mapKind:function(e,t,n){t&&(a[e]=t),n&&(r[e]=n)},convertKindToModuleId:function(e){return r[e]||"durandal/widgets/"+e+"/controller"},convertKindToView:function(e){return a[e]||"durandal/widgets/"+e+"/view"},beforeBind:function(e,t){var n=s.getParts(e),o=s.getParts(t);for(var i in n)$(o[i]).replaceWith(n[i])},createCompositionSettings:function(e){return e.model||(e.model=this.convertKindToModuleId(e.kind)),e.view||(e.view=this.convertKindToView(e.kind)),e.preserveContext=!0,e.beforeBind=this.beforeBind,e},create:function(e,t,o){"string"==typeof t&&(t={kind:t});var i=s.createCompositionSettings(t);n.compose(e,i,o)}};return ko.bindingHandlers.widget={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t,n,o,i){var r=s.getSettings(t);s.create(e,r,i)}},ko.virtualElements.allowedBindings.widget=!0,s}),n("durandal/modalDialog",["require","./composition","./system","./viewModel"],function(e){function t(e){return o.defer(function(t){"string"==typeof e?o.acquire(e).then(function(e){"function"==typeof e?t.resolve(new e):t.resolve(e)}):t.resolve(e)}).promise()}var n=e("./composition"),o=e("./system"),i=e("./viewModel"),r={},a=0,s={currentZIndex:1e3,getNextZIndex:function(){return++this.currentZIndex},isModalOpen:function(){return a>0},getContext:function(e){return r[e||"default"]},addContext:function(e,t){t.name=e,r[e]=t;var n="show"+e.substr(0,1).toUpperCase()+e.substr(1);this[n]=function(t,n){return this.show(t,n,e)}},createCompositionSettings:function(e,t){var n={model:e,activate:!1};return t.afterCompose&&(n.afterCompose=t.afterCompose),n},show:function(e,s,c){var u=this,l=r[c||"default"];return o.defer(function(o){t(e).then(function(e){var t=i.activator();t.activateItem(e,s).then(function(i){if(i){var r=e.modal={owner:e,context:l,activator:t,close:function(n){t.deactivateItem(e,!0).then(function(t){t&&(a--,l.removeHost(r),delete e.modal,o.resolve(n))})}};r.settings=u.createCompositionSettings(e,l),l.addHost(r),a++,n.compose(r.host,r.settings)}else o.resolve(!1)})})}).promise()}};return s.addContext("default",{blockoutOpacity:.2,removeDelay:200,addHost:function(e){var t=$("body"),n=$('<div class="modalBlockout"></div>').css({"z-index":s.getNextZIndex(),opacity:this.blockoutOpacity}).appendTo(t),o=$('<div class="modalHost"></div>').css({"z-index":s.getNextZIndex()}).appendTo(t);if(e.host=o.get(0),e.blockout=n.get(0),!s.isModalOpen()){e.oldBodyMarginRight=$("body").css("margin-right");var i=$("html"),r=t.outerWidth(!0),a=i.scrollTop();$("html").css("overflow-y","hidden");var c=$("body").outerWidth(!0);t.css("margin-right",c-r+parseInt(e.oldBodyMarginRight)+"px"),i.scrollTop(a),$("#simplemodal-overlay").css("width",c+"px")}},removeHost:function(e){if($(e.host).css("opacity",0),$(e.blockout).css("opacity",0),setTimeout(function(){$(e.host).remove(),$(e.blockout).remove()},this.removeDelay),!s.isModalOpen()){var t=$("html"),n=t.scrollTop();t.css("overflow-y","").scrollTop(n),$("body").css("margin-right",e.oldBodyMarginRight)}},afterCompose:function(e,t,n){var o=$(t),i=o.width(),r=o.height();o.css({"margin-top":""+-r/2+"px","margin-left":""+-i/2+"px"}),$(n.model.modal.host).css("opacity",1),$(t).hasClass("autoclose")&&$(n.model.modal.blockout).click(function(){n.model.modal.close()}),$(".autofocus",t).each(function(){$(this).focus()})}}),s}),n("durandal/events",["require","./system"],function(e){var t=e("./system"),n=/\s+/,o=function(){},i=function(e,t){this.owner=e,this.events=t};return i.prototype.then=function(e,t){return this.callback=e||this.callback,this.context=t||this.context,this.callback?(this.owner.on(this.events,this.callback,this.context),this):this},i.prototype.on=i.prototype.then,i.prototype.off=function(){return this.owner.off(this.events,this.callback,this.context),this},o.prototype.on=function(e,t,o){var r,a,s;if(t){for(r=this.callbacks||(this.callbacks={}),e=e.split(n);a=e.shift();)s=r[a]||(r[a]=[]),s.push(t,o);return this}return new i(this,e)},o.prototype.off=function(e,o,i){var r,a,s,c;if(!(a=this.callbacks))return this;if(!(e||o||i))return delete this.callbacks,this;for(e=e?e.split(n):t.keys(a);r=e.shift();)if((s=a[r])&&(o||i))for(c=s.length-2;c>=0;c-=2)o&&s[c]!==o||i&&s[c+1]!==i||s.splice(c,2);else delete a[r];return this},o.prototype.trigger=function(e){var t,o,i,r,a,s,c,u;if(!(o=this.callbacks))return this;for(u=[],e=e.split(n),r=1,a=arguments.length;a>r;r++)u[r-1]=arguments[r];for(;t=e.shift();){if((c=o.all)&&(c=c.slice()),(i=o[t])&&(i=i.slice()),i)for(r=0,a=i.length;a>r;r+=2)i[r].apply(i[r+1]||this,u);if(c)for(s=[t].concat(u),r=0,a=c.length;a>r;r+=2)c[r].apply(c[r+1]||this,s)}return this},o.prototype.proxy=function(e){var t=this;return function(n){t.trigger(e,n)}},o.includeIn=function(e){e.on=o.prototype.on,e.off=o.prototype.off,e.trigger=o.prototype.trigger,e.proxy=o.prototype.proxy},o}),n("durandal/app",["require","./system","./viewEngine","./composition","./widget","./modalDialog","./events"],function(e){var t,n=e("./system"),o=e("./viewEngine"),i=e("./composition"),r=(e("./widget"),e("./modalDialog")),a=e("./events"),s={showModal:function(e,t,n){return r.show(e,t,n)},showMessage:function(e,n,o){return r.show(new t(e,n,o))},start:function(){return n.defer(function(e){$(function(){n.log("Starting Application"),n.acquire("./messageBox").then(function(o){t=o,e.resolve(),n.log("Started Application")})})}).promise()},setRoot:function(e,t,n){var r,a={activate:!0,transition:t};r=n&&"string"!=typeof n?n:document.getElementById(n||"applicationHost"),"string"==typeof e?-1!=e.indexOf(o.viewExtension)?a.view=e:a.model=e:a.model=e,i.compose(r,a)},adaptToDevice:function(){document.body.ontouchmove&&(document.body.ontouchmove=function(e){e.preventDefault()})}};return a.includeIn(s),s}),n("durandal/plugins/router",["require","../system","../viewModel"],function(e){function t(e,t,n){t.routeInfo=e,t.router=u,v.log("Activating Route",e,n,t),x.activateItem(n,t).then(function(o){o?(u.onNavigationComplete(e,t,n),f=n,l=c.last_location[1].replace("/","")):(b=!0,v.log("Cancelling Navigation"),c.setLocation(l),b=!1,y(!1)),u.dfd&&(w(!0),u.dfd.resolve(),delete u.dfd)})}function n(){return b||c.last_location[1].replace("/","")==l}function o(e,o){var i=m[e];if(!n()){if(!i){if(!u.autoConvertRouteToModuleId)return u.handleInvalidRoute(e,o),void 0;i={moduleId:u.autoConvertRouteToModuleId(e,o),name:u.convertRouteToName(e)}}y(!0),v.acquire(i.moduleId).then(function(e){"function"==typeof e?t(i,o,new e):t(i,o,e)})}}function i(){o(d,this.params||{})}function r(){o(""+this.app.last_route.path,this.params||{})}function a(){var e,t=this.params||{};if(u.autoConvertRouteToModuleId){var n=this.path.split("#/");if(2==n.length){var i=n[1].split("/");e=i[0];var r=i.splice(1);return r.length>0&&(t.splat=r),o(e,t),void 0}}u.handleInvalidRoute(this.app.last_location[1],t)}function s(e){return u.prepareRouteInfo(e),m[e.url]=e,g.push(e),e.visible&&(e.isActive=ko.computed(function(){return w()&&x()&&x().__moduleId__==e.moduleId}),h.push(e)),e}var c,u,l,f,d,v=e("../system"),p=e("../viewModel"),m={},g=ko.observableArray([]),h=ko.observableArray([]),w=ko.observable(!1),y=ko.observable(!1),b=!1,x=p.activator();return x.settings.areSameItem=function(){return!1},u={ready:w,allRoutes:g,visibleRoutes:h,isNavigating:y,activeItem:x,afterCompose:function(){y(!1)},useConvention:function(e){e=null==e?"viewmodels":e,e&&(e+="/"),u.convertRouteToModuleId=function(t){return e+u.stripParameter(t)}},stripParameter:function(e){var t=e.indexOf(":"),n=t>0?t-1:e.length;return e.substring(0,n)},handleInvalidRoute:function(e,t){v.log("No Route Found",e,t)},onNavigationComplete:function(e){document.title=e.name},navigateBack:function(){window.history.back()},navigateTo:function(e){c.setLocation(e)},replaceLocation:function(e){window.location.replace(e)},convertRouteToName:function(e){var t=u.stripParameter(e);return t.substring(0,1).toUpperCase()+t.substring(1)},convertRouteToModuleId:function(e){return u.stripParameter(e)},prepareRouteInfo:function(e){e.url instanceof RegExp||(e.name=e.name||u.convertRouteToName(e.url),e.moduleId=e.moduleId||u.convertRouteToModuleId(e.url),e.hash=e.hash||"#/"+e.url),e.caption=e.caption||e.name,e.settings=e.settings||{}},mapAuto:function(e){e=e||"viewmodels",e+="/",u.autoConvertRouteToModuleId=function(t){return e+u.stripParameter(t)}},mapNav:function(e,t,n){return"string"==typeof e?this.mapRoute(e,t,n,!0):(e.visible=!0,s(e))},mapRoute:function(e,t,n,o){return"string"==typeof e?s({url:e,moduleId:t,name:n,visible:o}):s(e)},map:function(e){if(!v.isArray(e))return s(e);for(var t=[],n=0;e.length>n;n++)t.push(s(e[n]));return t},activate:function(e){return v.defer(function(t){var n;u.dfd=t,d=e,c=Sammy(function(e){for(var t=g(),o=0;t.length>o;o++){var s=t[o];e.get(s.url,r),n=this.routes.get[o],m[""+n.path]=s}e.get(/\#\/(.*)/,a),e.get("",i)}),c._checkFormSubmission=function(){return!1},c.log=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("Sammy"),v.log.apply(v,e)},c.run()}).promise()}}}),n("services/logger",["durandal/system"],function(e){function t(e,t,n,i){o(e,t,n,i,"info")}function n(e,t,n,i){o(e,t,n,i,"error")}function o(t,n,o,i,r){o=o?"["+o+"] ":"",n?e.log(o,t,n):e.log(o,t),i&&("error"===r?toastr.error(t):toastr.info(t))}var i={log:t,logError:n};return i}),t.config({paths:{text:"durandal/amd/text"}}),n("main",["durandal/app","durandal/viewLocator","durandal/system","durandal/plugins/router","services/logger"],function(e,t,n,o,i){n.debug(!0),e.start().then(function(){toastr.options.positionClass="toast-bottom-right",toastr.options.backgroundpositionClass="toast-bottom-right",o.handleInvalidRoute=function(e){i.logError("No Route Found",e,"main",!0)},o.useConvention(),t.useConvention(),e.adaptToDevice(),e.setRoot("viewmodels/shell","entrance")})}),n("durandal/http",[],function(){return{defaultJSONPCallbackParam:"callback",get:function(e,t){return $.ajax(e,t)},jsonp:function(e,t,n){return-1==e.indexOf("=?")&&(n=n||this.defaultJSONPCallbackParam,e+=-1==e.indexOf("?")?"?":"&",e+=n+"=?"),$.ajax({url:e,dataType:"jsonp",data:t})},post:function(e,t){return $.ajax({url:e,data:JSON.stringify(t),type:"POST",contentType:"application/json",dataType:"json"})}}}),n("text",["module"],function(e){var n,o,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,s="undefined"!=typeof location&&location.href,c=s&&location.protocol&&location.protocol.replace(/\:/,""),u=s&&location.hostname,l=s&&(location.port||void 0),f=[],d=e.config&&e.config()||{};return n={version:"2.0.3",strip:function(e){if(e){e=e.replace(r,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=i[t];try{e=new ActiveXObject(n)}catch(o){}if(e){i=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),o=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),-1!==n&&(t=i.substring(n+1,i.length),t="strip"===t,i=i.substring(0,n)),{moduleName:o,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,o,i){var r,a,s,c=n.xdRegExp.exec(e);return c?(r=c[2],a=c[3],a=a.split(":"),s=a[1],a=a[0],!(r&&r!==t||a&&a.toLowerCase()!==o.toLowerCase()||(s||a)&&s!==i)):!0},finishLoad:function(e,t,o,i){o=t?n.strip(o):o,d.isBuild&&(f[e]=o),i(o)},load:function(e,t,o,i){if(i.isBuild&&!i.inlineText)return o(),void 0;d.isBuild=i.isBuild;var r=n.parseName(e),a=r.moduleName+"."+r.ext,f=t.toUrl(a),v=d.useXhr||n.useXhr;!s||v(f,c,u,l)?n.get(f,function(t){n.finishLoad(e,r.strip,t,o)},function(e){o.error&&o.error(e)}):t([a],function(e){n.finishLoad(r.moduleName+"."+r.ext,r.strip,e,o)})},write:function(e,t,o){if(f.hasOwnProperty(t)){var i=n.jsEscape(f[t]);o.asModule(e+"!"+t,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,t,o,i,r){var a=n.parseName(t),s=a.moduleName+"."+a.ext,c=o.toUrl(a.moduleName+"."+a.ext)+".js";n.load(s,o,function(){var t=function(e){return i(c,e)};t.asModule=function(e,t){return i.asModule(e,c,t)},n.write(e,s,t,r)},r)}},"node"===d.env||!d.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(o=t.nodeRequire("fs"),n.get=function(e,t){var n=o.readFileSync(e,"utf8");0===n.indexOf("﻿")&&(n=n.substring(1)),t(n)}):"xhr"===d.env||!d.env&&n.createXhr()?n.get=function(e,t,o){var i=n.createXhr();i.open("GET",e,!0),d.onXhr&&d.onXhr(i,e),i.onreadystatechange=function(){var n,r;4===i.readyState&&(n=i.status,n>399&&600>n?(r=Error(e+" HTTP status: "+n),r.xhr=i,o(r)):t(i.responseText))},i.send(null)}:("rhino"===d.env||!d.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(n.get=function(e,t){var n,o,i="utf-8",r=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),i)),c="";try{for(n=new java.lang.StringBuffer,o=s.readLine(),o&&o.length()&&65279===o.charAt(0)&&(o=o.substring(1)),n.append(o);null!==(o=s.readLine());)n.append(a),n.append(o);c=""+n+""}finally{s.close()}t(c)}),n}),n("text!durandal/messageBox.html",[],function(){return'<div class="messageBox">\r\n    <div class="modal-header">\r\n        <h3 data-bind="html: title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <p class="message" data-bind="html: message"></p>\r\n    </div>\r\n    <div class="modal-footer" data-bind="foreach: options">\r\n        <button class="btn" data-bind="click: function () { $parent.selectOption($data); }, html: $data, css: { \'btn-primary\': $index() == 0, autofocus: $index() == 0 }"></button>\r\n    </div>\r\n</div>'}),n("durandal/messageBox",[],function(){var e=function(t,n,o){this.message=t,this.title=n||e.defaultTitle,this.options=o||e.defaultOptions};return e.prototype.selectOption=function(e){this.modal.close(e)},e.defaultTitle="Application",e.defaultOptions=["Ok"],e}),n("durandal/transitions/entrance",["require","../system"],function(e){var t=e("../system"),n=100,o=function(e,o,i){return t.defer(function(t){function r(){t.resolve()}function a(){i.cacheViews?i.composingNewView&&ko.virtualElements.prepend(e,o):(ko.virtualElements.emptyNode(e),ko.virtualElements.prepend(e,o));var t={marginLeft:"20px",marginRight:"-20px",opacity:0,display:"block"},n={marginRight:0,marginLeft:0,opacity:1};$(o).css(t),$(o).animate(n,c,"swing",r)}if(i.keepScrollPosition||$(document).scrollTop(0),o){var s=$(i.activeView),c=i.duration||500;s.length?s.fadeOut(n,a):a()}else i.activeView?$(i.activeView).fadeOut(n,function(){i.cacheViews||ko.virtualElements.emptyNode(e),r()}):(i.cacheViews||ko.virtualElements.emptyNode(e),r())}).promise()};return o}),n("viewmodels/details",["services/logger"],function(e){function t(){return e.log("Details View Activated",null,"details",!0),!0}var n={activate:t,title:"Details View"};return n}),n("viewmodels/home",["services/logger"],function(e){function t(){return e.log("Home View Activated",null,"home",!0),!0}var n={activate:t,title:"Home View"};return n}),n("viewmodels/shell",["durandal/system","durandal/plugins/router","services/logger"],function(e,t,n){function o(){return i()}function i(){return t.mapNav("home"),t.mapNav("details"),r("Hot Towel SPA Loaded!",null,!0),t.activate("home")}function r(t,o,i){n.log(t,o,e.getModuleId(s),i)}var a=ko.computed(function(){return t.allRoutes().filter(function(e){return e.settings.admin})}),s={activate:o,adminRoutes:a,router:t};return s}),n("text!views/details.html",[],function(){return'<section>\r\n    <h2 class="page-title">Details View</h2>\r\n</section>'}),n("text!views/footer.html",[],function(){return'<nav class="navbar navbar-fixed-bottom">\r\n    <div class="navbar-inner navbar-content-center">\r\n        <span class="pull-left">Learn how to <a href="http://jpapa.me/spajumpstart" target="_blank">build a SPA </a> at Pluralsight</span>\r\n        <span class="pull-right">Hot Towel SPA - © 2013 <a href="http://johnpapa.net" target="_blank">JohnPapa.net</a></span>\r\n    </div>\r\n</nav>\r\n'}),n("text!views/home.html",[],function(){return'<section>\r\n    <h2 class="page-title">Home View</h2>\r\n</section>'}),n("text!views/nav.html",[],function(){return'<nav class="navbar navbar-fixed-top">\r\n    <div class="navbar-inner">\r\n        <a class="brand" href="/">\r\n            <span class="title">Hot Towel SPA</span> \r\n        </a>\r\n        <div class="btn-group" data-bind="foreach: router.visibleRoutes">\r\n            <a data-bind="css: { active: isActive }, attr: { href: hash }, text: name" \r\n                class="btn btn-info" href="#"></a>\r\n        </div>\r\n        <div class="loader pull-right" data-bind="css: { active: router.isNavigating }">\r\n            <div class="progress progress-striped active page-progress-bar">\r\n                <div class="bar" style="width: 100px;"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</nav>'
}),n("text!views/shell.html",[],function(){return"<div>\r\n    <header>\r\n        <!--ko compose: {view: 'nav'} --><!--/ko-->\r\n    </header>\r\n     <section id=\"content\" class=\"main container-fluid\">\r\n        <!--ko compose: {model: router.activeItem, \r\n            afterCompose: router.afterCompose, \r\n            transition: 'entrance'} -->\r\n        <!--/ko-->\r\n    </section>\r\n    <footer>\r\n        <!--ko compose: {view: 'footer'} --><!--/ko-->\r\n    </footer>\r\n</div>\r\n"}),t(["main"])})();